{% load static %}
{% load cache %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{% block title %}AgriGestión{% endblock title %}</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet"
          href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="{% static 'plugins/fontawesome-free/css/all.min.css' %}">
    <link href="{% static 'fontawesomefree/css/fontawesome.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'fontawesomefree/css/brands.css' %}" rel="stylesheet" type="text/css">
    <link href="{% static 'fontawesomefree/css/solid.css' %}" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="//code.jquery.com/ui/1.13.2/themes/base/jquery-ui.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Tempusdominus Bootstrap 4 -->
    <link rel="stylesheet"
          href="{% static 'plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css' %}">
    <!-- iCheck -->
    <link rel="stylesheet" href="{% static 'plugins/icheck-bootstrap/icheck-bootstrap.min.css' %}">
    <!-- JQVMap -->
    <link rel="stylesheet" href="{% static 'plugins/jqvmap/jqvmap.min.css' %}">
    <!-- Theme style -->
    <link rel="stylesheet" href="{% static 'fonts/bankgothick/font-bankgothick.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/adminlte.min.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/stylazos.css' %}">
    <!-- overlayScrollbars -->
    <link rel="stylesheet" href="{% static 'plugins/overlayScrollbars/css/OverlayScrollbars.min.css' %}">
    <!-- Daterange picker -->
    <link rel="stylesheet" href="{% static 'plugins/daterangepicker/daterangepicker.css' %}">
    <!-- summernote -->
    <link rel="stylesheet" href="{% static 'plugins/summernote/summernote-bs4.min.css' %}">

    <link rel="stylesheet" href="{% static 'assets/css/autocomplete.css' %}">
    <link rel="stylesheet" href="{% static 'assets/toastr/toastr.min.css' %}">

    <link rel="stylesheet" href="{% static 'vendor/datatables/datatables.min.css' %}">
    <link rel="stylesheet" href="{% static 'vendor/select2/select2.min.css' %}">
    <link rel="stylesheet" href="{% static 'vendor/select2/select2-bootstrap4.css' %}">
    <link rel="stylesheet" href="{% static 'assets/css/loader.css' %}">
    {#    <link rel="icon" type="image/ico" href="{% static 'assets/img/LOGO.png' %}">#}
    <link rel="icon" href="{% static 'assets/img/logo_farm.png' %}" type="image/png"/>

    <!-- fullCalendar -->
    <link rel="stylesheet" href="{% static 'plugins/fullcalendar/main.css' %}">
    
    <!-- CSS personalizado por página -->
    {% block extra_css %}{% endblock extra_css %}eso es bueno

    
    <style>
        /* ====== SIDEBAR GENERAL ====== */
        .main-sidebar {
            width: 260px;
            background: #ffffff;
            border-right: 1px solid #e5e9f2;
            padding-top: 20px;
            position: fixed;
            height: 100%;
            transition: all 0.3s ease;
        }

        /* LOGO MEJORADO */
        .brand-link {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 15px;
            border-bottom: 1px solid #f0f2f5;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .brand-link:hover {
            text-decoration: none;
            background: rgba(63, 81, 181, 0.05);
        }

        .brand-link .brand-image {
            width: 60px;
            height: 60px;
            object-fit: cover;
            margin-bottom: 8px;
            border: 3px solid #3f51b5;
            box-shadow: 0 4px 8px rgba(63, 81, 181, 0.2);
            transition: all 0.3s ease;
        }

        .brand-link:hover .brand-image {
            transform: scale(1.05);
            box-shadow: 0 6px 12px rgba(63, 81, 181, 0.3);
        }

        .brand-link .brand-text {
            font-weight: 700;
            color: #3f51b5;
            font-size: 16px;
            font-family: 'Source Sans Pro', sans-serif;
            letter-spacing: 0.5px;
            text-align: center;
            margin: 0;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
        }

        /* NAV ITEMS */
        .nav-sidebar .nav-item > .nav-link {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: #333;
            font-weight: 500;
            border-radius: 8px;
            transition: background 0.3s, color 0.3s;
        }

        .nav-sidebar .nav-item > .nav-link:hover {
            background: #f0f4ff;
            color: #3f51b5;
        }

        .nav-sidebar .nav-icon {
            margin-right: 12px;
            font-size: 18px;
            color: #555;
        }

        .nav-sidebar .nav-link p {
            margin: 0;
            font-size: 15px;
        }

        /* ACTIVE LINK */
        .nav-sidebar .nav-link.active,
        .nav-sidebar .nav-link.active:hover {
            background: #e8f0fe;
            color: #3f51b5;
            font-weight: 600;
        }

        /* SUBMENU */
        .nav-treeview {
            padding-left: 20px;
        }

        .nav-treeview .nav-item .nav-link {
            font-size: 14px;
            padding: 8px 20px;
            color: #555;
            border-radius: 6px;
        }

        .nav-treeview .nav-item .nav-link:hover {
            background: #f0f4ff;
            color: #3f51b5;
        }

        /* SEPARADORES (TÍTULOS DE SECCIÓN) */
        .nav-header {
            font-size: 12px;
            font-weight: bold;
            color: #3f51b5;
            margin: 15px 20px 5px;
            text-transform: uppercase;
        }

        /* ICONOS MÁS MODERNOS - Solo para el home */
        .main-sidebar .nav-sidebar .fa-angle-left {
            margin-left: auto;
            transition: transform 0.3s;
        }

        .main-sidebar .nav-item.menu-open > .nav-link .fa-angle-left {
            transform: rotate(-90deg);
        }

        /* BRAND HEADER */
        .brand-link {
            display: flex;
            flex-direction: column; /* Logo arriba, texto abajo */
            align-items: center;
            justify-content: center;
            padding: 30px 10px;
            padding-top: 50px;
            border-bottom: 1px solid #f0f2f5;
            text-decoration: none;
            background: #fff;
        }

        .brand-link .brand-image {
            width: 40px; /* Más grande */
            height: 60px;
            object-fit: contain;
            border-radius: 50%; /* Circular elegante */
            margin-bottom: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1); /* Sombra sutil */
        }

        .brand-link .brand-text {
            font-weight: 600;
            font-size: 16px;
            color: #3f51b5; /* Azul Material */
            letter-spacing: 0.5px;
        }

        .brand-subtitle {
            margin-top: 2px;
        }

        .brand-subtitle small {
            font-size: 11px;
            color: #6c757d;
            font-weight: 500;
        }

        .layout-navbar-fixed.layout-fixed .wrapper .sidebar {
            margin-top: calc(1.0rem + 1px);
        }

        /* INFORMACIÓN DEL USUARIO EN SIDEBAR */
        .user-info-sidebar {
            background: linear-gradient(135deg, #f8f9fc 0%, #e9ecef 100%);
            margin: 8px 10px;
            padding: 10px 15px;
            border-radius: 12px;
            border: 1px solid #e3e6f0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .user-avatar-sidebar {
            text-align: center;
            margin-bottom: 8px;
        }

        .user-avatar-sidebar img {
            border: 3px solid #3f51b5;
            box-shadow: 0 2px 6px rgba(63, 81, 181, 0.3);
        }

        .user-details-sidebar {
            text-align: center;
        }

        .user-name-sidebar {
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .user-role-sidebar,
        .user-subsidiary-sidebar {
            font-size: 11px;
            color: #6c757d;
            margin-bottom: 3px;
        }

        .user-role-sidebar i,
        .user-subsidiary-sidebar i {
            color: #3f51b5;
        }

        /* ESTADÍSTICAS RÁPIDAS DEL SIDEBAR */
        .sidebar-stats {
            margin: 10px;
            background: #fff;
            border-radius: 12px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            border: 1px solid #e3e6f0;
        }

        .stat-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f8f9fc;
        }

        .stat-item:last-child {
            border-bottom: none;
        }

        .stat-icon {
            width: 35px;
            height: 35px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            background: #f8f9fc;
        }

        .stat-icon i {
            font-size: 16px;
        }

        .stat-content {
            flex: 1;
        }

        .stat-number {
            font-weight: 700;
            font-size: 16px;
            color: #2c3e50;
            line-height: 1;
        }

        .stat-label {
            font-size: 10px;
            color: #6c757d;
            font-weight: 500;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        /* ESTILOS PARA SIDEBAR CONTRAÍDO (sidebar-mini) */
        .sidebar-mini .user-info-sidebar {
            margin: 5px;
            padding: 8px 5px;
            text-align: center;
        }

        .sidebar-mini .user-avatar-sidebar {
            margin-bottom: 5px;
        }

        .sidebar-mini .user-avatar-sidebar img {
            width: 35px;
            height: 35px;
        }

        .sidebar-mini .user-details-sidebar {
            display: none; /* Ocultar detalles del usuario cuando está contraído */
        }

        /* Mostrar solo el avatar cuando está contraído */
        .sidebar-mini .user-info-sidebar:hover .user-details-sidebar {
            display: block;
            position: absolute;
            background: white;
            border: 1px solid #e3e6f0;
            border-radius: 8px;
            padding: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 1000;
            left: 60px;
            top: 0;
            min-width: 200px;
            text-align: left;
            animation: fadeInTooltip 0.3s ease;
        }

        @keyframes fadeInTooltip {
            from {
                opacity: 0;
                transform: translateX(-10px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Tooltip para el avatar cuando está contraído */
        .sidebar-mini .user-info-sidebar::after {
            content: attr(data-tooltip);
            position: absolute;
            left: 50px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 11px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
            z-index: 1001;
        }

        .sidebar-mini .user-info-sidebar:hover::after {
            opacity: 1;
        }

        .sidebar-mini .user-info-sidebar {
            position: relative;
        }

        /* Ajustar el padding del sidebar cuando está contraído */
        .sidebar-mini .sidebar {
            padding-top: 10px;
        }

        /* AJUSTE DE LAS FLECHAS EN LOS MENÚS */
        .nav-sidebar .fa-angle-left {
            margin-left: auto; /* Lo manda a la derecha */
            font-size: 12px;
            color: #888;
            position: relative;
            right: 5px; /* un poco separado del borde */
        }

        /* ICONOS DE MENU CON ANCHO FIJO */
        .nav-sidebar .nav-icon {
            width: 20px;
            text-align: center;
            margin-right: 10px;
        }

        /* ESTILOS PARA DASHBOARD MEJORADO */
        .border-left-primary {
            border-left: 0.25rem solid #4e73df !important;
        }

        .border-left-success {
            border-left: 0.25rem solid #1cc88a !important;
        }

        .border-left-info {
            border-left: 0.25rem solid #36b9cc !important;
        }

        .border-left-warning {
            border-left: 0.25rem solid #f6c23e !important;
        }

        .text-gray-300 {
            color: #dddfeb !important;
        }

        .text-gray-800 {
            color: #5a5c69 !important;
        }

        .text-xs {
            font-size: 0.7rem;
        }

        /* TIMELINE STYLES */
        .timeline {
            position: relative;
            padding-left: 30px;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: #e3e6f0;
        }

        .timeline-item {
            position: relative;
            margin-bottom: 20px;
            padding-left: 20px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -8px;
            top: 5px;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #4e73df;
            border: 3px solid #fff;
            box-shadow: 0 0 0 3px #e3e6f0;
        }

        .timeline-item.success::before {
            background: #1cc88a;
        }

        .timeline-item.warning::before {
            background: #f6c23e;
        }

        .timeline-item.danger::before {
            background: #e74a3c;
        }

        .timeline-content {
            background: #f8f9fc;
            padding: 15px;
            border-radius: 8px;
            border-left: 3px solid #4e73df;
        }

        .timeline-item.success .timeline-content {
            border-left-color: #1cc88a;
        }

        .timeline-item.warning .timeline-content {
            border-left-color: #f6c23e;
        }

        .timeline-item.danger .timeline-content {
            border-left-color: #e74a3c;
        }

        /* NOTIFICATION STYLES */
        .notification-item {
            padding: 10px 0;
            border-bottom: 1px solid #e3e6f0;
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-item.unread {
            background: #f8f9fc;
            border-left: 3px solid #4e73df;
            padding-left: 10px;
        }

        .notification-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
        }

        .notification-icon.info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .notification-icon.success {
            background: #d4edda;
            color: #155724;
        }

        .notification-icon.warning {
            background: #fff3cd;
            color: #856404;
        }

        .notification-icon.danger {
            background: #f8d7da;
            color: #721c24;
        }

        /* CARD SHADOWS */
        .card.shadow {
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15) !important;
        }

        .card.shadow-lg {
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15) !important;
        }

        /* GRADIENT HEADERS */
        .bg-gradient-primary {
            background: linear-gradient(45deg, #4e73df 10%, #224abe 100%) !important;
        }

        .bg-gradient-success {
            background: linear-gradient(45deg, #1cc88a 10%, #13855c 100%) !important;
        }

        .bg-gradient-info {
            background: linear-gradient(45deg, #36b9cc 10%, #258391 100%) !important;
        }

        .bg-gradient-warning {
            background: linear-gradient(45deg, #f6c23e 10%, #dda20a 100%) !important;
        }

        .bg-gradient-danger {
            background: linear-gradient(45deg, #e74a3c 10%, #c0392b 100%) !important;
        }

        /* Estilos para el dropdown del usuario */
        .dropdown-menu {
            border: none;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            border-radius: 12px;
            padding: 0;
            overflow: hidden;
        }

        .dropdown-header {
            background: #f6f8f9;
            color: #495057;
            padding: 15px 20px;
            font-size: 1.1rem;
        }

        .dropdown-divider {
            margin: 0;
            border-color: rgba(0, 0, 0, 0.1);
        }

        .dropdown-menu .px-3.py-2 {
            padding: 15px 20px !important;
            background: #f8f9fa;
        }

        .dropdown-menu .px-3.py-2 small {
            font-size: 0.8rem;
            color: #6c757d;
        }

        .dropdown-menu .px-3.py-2 strong {
            color: #495057;
            font-size: 1rem;
        }

        /* Estilos para el perfil del usuario en el navbar */
        .user-profile-info {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 25px;
            padding: 8px 15px;
            transition: all 0.3s ease;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .user-profile-info:hover {
            background: rgba(0, 0, 0, 0.1);
            transform: translateY(-1px);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        .user-avatar img {
            border: 2px solid rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .user-profile-info:hover .user-avatar img {
            border-color: rgba(0, 0, 0, 0.2);
            transform: scale(1.05);
        }

        .user-details {
            min-width: 120px;
        }

        .user-name {
            font-size: 0.8rem;
            line-height: 1.2;
            margin-bottom: 2px;
            color: #495057;
        }

        .user-subsidiary {
            font-size: 0.70rem;
            line-height: 1.2;
            opacity: 0.7;
            color: #6c757d;
        }

        /* Estilos para los items del dropdown */
        .dropdown-item {
            padding: 10px 20px;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .dropdown-item:hover {
            background: linear-gradient(135deg, rgba(240, 248, 255, 0.8) 0%, rgba(240, 248, 255, 0.9) 100%);
            border-left-color: #6c757d;
            transform: translateX(5px);
        }

        .dropdown-item i {
            width: 16px;
            text-align: center;
            color: #6c757d;
        }

        .header {
            background: white;
            box-shadow: var(--shadow);
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 70px;
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 24px;
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        /* Estilos personalizados para el navbar */
        .main-header {
            background: #f6f8f9 !important;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }

        .main-header .navbar-nav .nav-link {
            color: rgba(0, 0, 0, 0.7) !important;
            font-weight: 500;
            transition: all 0.3s ease;
            border-radius: 6px;
            margin: 0 2px;
        }

        .main-header .navbar-nav .nav-link:hover {
            color: #000000 !important;
            background: rgba(0, 0, 0, 0.05);
            transform: translateY(-1px);
        }

        .main-header .navbar-brand h4 {
            text-shadow: none;
            letter-spacing: 0.5px;
        }

        .main-header .navbar-brand i {
            color: #6c757d;
            text-shadow: none;
        }

        /* ESTILOS PARA EL NOMBRE DE SUCURSAL CENTRADO */
        .navbar-center {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            align-items: center;
        }

        .subsidiary-info {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.9);
            padding: 8px 16px;
            border-radius: 20px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }

        .subsidiary-info:hover {
            background: rgba(255, 255, 255, 1);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }

        .subsidiary-info i {
            color: #3f51b5;
            font-size: 14px;
        }

        .subsidiary-name {
            font-weight: 600;
            color: #2c3e50;
            font-size: 14px;
            letter-spacing: 0.3px;
        }

        /* Responsive para móviles */
        @media (max-width: 768px) {
            .navbar-center {
                display: none; /* Ocultar en móviles para ahorrar espacio */
            }
        }


    </style>


</head>
<body class="hold-transition sidebar-collapse sidebar-mini layout-fixed layout-navbar-fixed layout-footer-fixed">

<div class="wrapper">
    <!-- Preloader -->
    <div class="preloader flex-column justify-content-center align-items-center">
        <a href="{% url 'home' %}">
            <img class="animation__shake" src="{% static 'assets/img/logo_farm.png' %}" alt="Logo" height="60"
                 width="60">
        </a>
    </div>
    <!-- Navbar -->

    <nav class="main-header navbar navbar-expand navbar-dark">
        <!-- Left navbar links -->
        <ul class="navbar-nav">
            <li class="nav-item">
                <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
            </li>
            <li class="nav-item d-none d-sm-inline-block">
                <a href="{% url 'home' %}" class="nav-link">Inicio</a>
            </li>
        </ul>

        <!-- Center - Sucursal Name -->
        <div class="navbar-center">
            <div class="subsidiary-info">
                <i class="fas fa-building mr-2"></i>
                <span class="subsidiary-name">{{ user.subsidiary.name|default:"Sede Principal" }}</span>
            </div>
        </div>

        <!-- Right navbar links -->
        <ul class="navbar-nav ml-auto">
            <!-- User Profile Section -->
            <li class="nav-item dropdown">
                <a class="nav-link dropdown-toggle d-flex align-items-center" href="#" id="userDropdown" role="button"
                   data-toggle="dropdown" aria-expanded="false">
                    <div class="user-profile-info d-flex align-items-center">
                        <div class="user-avatar mr-3">
                            {% if user.photo.url %}
                                <img src="{{ user.photo.url }}" class="img-circle elevation-2" alt="User Image"
                                     width="40" height="40">
                            {% else %}
                                <img src="{% static 'dist/img/user2-160x160.jpg' %}" class="img-circle elevation-2"
                                     alt="User Image" width="40" height="40">
                            {% endif %}
                        </div>
                        <div class="user-details text-left">
                            <div class="user-name text-dark font-weight-bold">{{ user.first_name }} {{ user.last_name }}</div>
                            <div class="user-subsidiary text-dark-50 small">{{ user.subsidiary.name|default:"No asignada" }}</div>
                        </div>
                    </div>
                </a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="userDropdown">
                    <div class="dropdown-header">
                        <strong>{{ user.first_name }} {{ user.last_name }}</strong>
                    </div>
                    <div class="dropdown-divider"></div>
                    <a class="dropdown-item" href="#">
                        <i class="fas fa-user mr-2"></i> Mi Cuenta
                    </a>
                    <a class="dropdown-item" href="#">
                        <i class="fas fa-key mr-2"></i> Cambiar Password
                    </a>
                    <a class="dropdown-item" href="#">
                        <i class="fas fa-envelope mr-2"></i> Mensajes
                    </a>
                    <div class="dropdown-divider"></div>
                    <div class="px-3 py-2">
                        <small class="text-muted">Sucursal:</small><br>
                        <strong>{{ user.subsidiary.name|default:"No asignada" }}</strong>
                    </div>
                </div>
            </li>

            <li class="nav-item">
                <a class="nav-link" data-widget="fullscreen" href="#" role="button">
                    <i class="fas fa-expand-arrows-alt"></i>
                </a>
            </li>

            <li class="nav-item">
                <a class="nav-link" data-toggle="tooltip" data-placement="bottom"
                   title="Cerrar Sesión"
                   href="{% url 'logout' %}">
                    <i class="fas fa-power-off fa-lg"></i>
                </a>
            </li>
        </ul>
    </nav>

    <!-- /.navbar -->

    <!-- Main Sidebar Container -->

    <aside class="main-sidebar sidebar-light-cyan elevation-4">
        <!-- Brand Logo -->
{#        <a href="{% url 'home' %}" class="brand-link">#}
{#            <img src="{% static 'assets/img/logo_medrano.jpeg' %}" alt="Logo"#}
{#                 class="brand-image img-circle elevation-3">#}
{#            <span class="brand-text font-weight-light">Medrano</span>#}
{#            <div class="brand-subtitle">#}
{#                <small class="text-muted">Sistema de Gestión</small>#}
{#            </div>#}
{#        </a>#}

        <!-- Información del Usuario en el Sidebar -->
        <div class="user-info-sidebar" data-tooltip="">
            <div class="user-avatar-sidebar">
{#                {% if user.photo.url %}#}
{#                    <img src="{{ user.subsidiary.photo.url }}" class="img-circle" alt="User Image" width="50" height="50">#}
{#                {% else %}#}
                    <img src="{% static 'assets/img/logo_farm.png' %}" class="img-circle" alt="User Image" width="50" height="50">
{#                {% endif %}#}
            </div>
            <div class="user-details-sidebar">
                <div class="user-name-sidebar">{{ user.first_name }} {{ user.last_name }}</div>
                <div class="user-role-sidebar">
                    <i class="fas fa-user-tie mr-1"></i>
                    <span>Administrador</span>
                </div>
                <div class="user-subsidiary-sidebar">
                    <i class="fas fa-building mr-1"></i>
                    <span>{{ user.subsidiary.name|default:"Sede Principal" }}</span>
                </div>
            </div>
        </div>

        <!-- Estadísticas Rápidas del Sidebar -->


        <!-- Sidebar -->
        <div class="sidebar">
            <!-- Sidebar Menu -->
            <nav class="mt-2 roboto-condensed-regular">
                {% if user.has_access_system %}
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu"
                        data-accordion="false">
                        {% if user.has_access_to_all or user.has_access_to_hrm %}
                            <!-- RECURSOS HUMANOS -->
                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-business-time"></i>
                                    <p>
                                        Recursos Humanos
                                        <i class="fas fa-angle-left right"></i>
                                    </p>
                                </a>

                                <ul class="nav nav-treeview">
                                    <li class="nav-item">
                                        <a href="{% url 'apps.hrm:subsidiary' %}"
                                           class="nav-link text-warning font-weight-light">
                                            <i class="far fa-circle nav-icon"></i>
                                            <p>Sucursales</p>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'apps.hrm:employee' %}"
                                           class="nav-link text-warning font-weight-light">
                                            <i class="nav-icon fas fa-user-tag"></i>
                                            <p>Empleados</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        {% endif %}
                        {% if user.has_access_to_all or user.has_access_to_sales %}
                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-tractor"></i>
                                    <p>
                                        Gestión Agrícola <i class="fas fa-angle-left right"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                    <li class="nav-item">
                                        <a href="{% url 'apps.farm:plot' %}"
                                           class="nav-link text-success font-weight-light">
                                            <i class="nav-icon fas fa-map-marked-alt"></i>
                                            <p>Parcelas</p>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'apps.farm:crop' %}"
                                           class="nav-link text-success font-weight-light">
                                            <i class="nav-icon fas fa-tractor"></i>
                                            <p>Sembríos / Campañas</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        {% endif %}
                        {% if user.has_access_to_all or user.has_access_to_sales %}
                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-book"></i>
                                    <p>
                                        Catálogos <i class="fas fa-angle-left right"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                    <li class="nav-item">
                                        <a href="{% url 'apps.farm:product' %}"
                                           class="nav-link text-success font-weight-light">
                                            <i class="nav-icon fas fa-box"></i>
                                            <p>Productos</p>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'apps.farm:crop_type' %}"
                                           class="nav-link text-success font-weight-light">
                                            <i class="nav-icon fas fa-seedling"></i>
                                            <p>Tipos de Cultivo</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        {% endif %}
                        {% if user.has_access_to_all or user.has_access_to_sales %}
                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-warehouse"></i>
                                    <p>
                                        Inventario <i class="fas fa-angle-left right"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                     <li class="nav-item">
                                        <a href="{% url 'apps.farm:inventory_transaction' %}"
                                           class="nav-link text-success font-weight-light">
                                            <i class="nav-icon fas fa-clipboard-list"></i>
                                            <p>Stock</p>
                                        </a>
                                    </li>
                                     <li class="nav-item">
                                        <a href="{% url 'apps.farm:inventory_transaction' %}"
                                           class="nav-link text-success font-weight-light">
                                            <i class="nav-icon fas fa-clipboard-list"></i>
                                            <p>Movimientos</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        {% endif %}
                        {% if user.has_access_to_all or user.has_access_to_sales %}
                            <!-- GRANJA -->
                            <li class="nav-item has-treeview">
                                <a href="#" class="nav-link">
                                    <i class="nav-icon fas fa-dollar-sign"></i>
                                    <p>
                                        Costos & Gastos <i class="fas fa-angle-left right"></i>
                                    </p>
                                </a>
                                <ul class="nav nav-treeview">
                                    <li class="nav-item">
                                        <a href="{% url 'apps.farm:crop_cycle_cost' %}"
                                           class="nav-link text-success font-weight-light">
                                            <i class="nav-icon fas fa-list-alt"></i>
                                            <p>Costos por Sembrío</p>
                                        </a>
                                    </li>
                                    <li class="nav-item">
                                        <a href="{% url 'apps.farm:crop' %}"
                                           class="nav-link text-success font-weight-light">
                                            <i class="nav-icon fas fa-chart-line"></i>
                                            <p>Reportes de Costos</p>
                                        </a>
                                    </li>
                                </ul>
                            </li>
                        {% endif %}
                        {% if user.has_access_to_all or user.has_access_to_finances %}
                            <!-- FINANZAS -->
                            <li class="nav-item has-treeview">
                                <a href="" class="nav-link">
                                    <i class="nav-icon fa-solid fa-calculator"></i>
                                    <p>
                                        Finanzas <i class="fas fa-angle-left right"></i>
                                    </p>
                                </a>

                            </li>
                        {% endif %}
                        {% if user.has_access_to_all or user.has_access_to_report %}
                            <!-- REPORTES -->
                            <li class="nav-item has-treeview">
                                <a href="" class="nav-link">
                                    <i class="nav-icon fa-solid fa-chart-bar"></i>
                                    <p>
                                        Reportes <i class="fas fa-angle-left right"></i>
                                    </p>
                                </a>
                                
                            </li>
                        {% endif %}
                    </ul>
                {% endif %}
            </nav>
            <!-- /.sidebar-menu -->
        </div>
        <!-- /.sidebar -->
    </aside>

    <!-- Content Wrapper. Contains page content -->
    <div class="content-wrapper">
        <!-- Content Header (Page header) -->

        <div class="container-fluid">
            <div class="row">
                <div class="col-sm-12">
                    {#                        <h1 class="m-0">Dashboard</h1>#}
                </div><!-- /.col -->
                {#                    <div class="col-sm-6">#}
                {#                        <ol class="breadcrumb float-sm-right">#}
                {#                            <li class="breadcrumb-item"><a href="#">Inicio</a></li>#}
                {#                        <li class="breadcrumb-item active">Dashboard v1</li>#}
                {#                    </ol>#}
                {#                </div><!-- /.col -->#}
            </div><!-- /.row -->
        </div><!-- /.container-fluid -->

        <!-- /.content-header -->

        <!-- Main content -->
        <section class="content p-2">
            {% block body %}
                <div class="container-fluid">
                    <!-- Botones de Acceso Rápido -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <!-- Mensaje de Bienvenida -->
                            <div class="welcome-section text-center mb-4">
                                <h2 class="welcome-title">
                                    <i class="fas fa-sun text-warning mr-2"></i>
                                    ¡Bienvenido, {{ user.first_name }}!
                                </h2>
                                    <p class="welcome-subtitle text-muted">
                                    AgriGestión - Sistema de Gestión Agrícola
                                </p>
                            </div>

                            <div class="card card-outline card-primary">
                                <div class="card-header">
                                    <h3 class="card-title">
                                        <i class="fas fa-rocket mr-2"></i>
                                        Acceso Rápido a Módulos
                                    </h3>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        {% if user.has_access_to_all or user.has_access_to_sales %}
                                            <div class="col-lg-3 col-md-6 mb-3">
                                                <a href=""
                                                   class="text-decoration-none">
                                                    <div class="quick-access-card bg-gradient-primary text-white text-center p-4 rounded-lg shadow-lg h-100">
                                                        <div class="quick-access-icon mb-3">
                                                            <i class="fas fa-user-graduate fa-3x"></i>
                                                        </div>
                                                        <h4 class="font-weight-bold mb-2">Academia</h4>
                                                        <p class="mb-0 opacity-75">Gestión de Deportistas y Suscripciones</p>
                                                        <div class="mt-3">
                                                            <span class="badge badge-light text-primary">Deportistas</span>
                                                            <span class="badge badge-light text-primary">Planes</span>
                                                            <span class="badge badge-light text-primary">Suscripciones</span>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        {% endif %}
                                        {% if user.has_access_to_all or user.has_access_to_finances %}
                                            <div class="col-lg-3 col-md-6 mb-3">
                                                <a href="{% url 'apps.accounting:cashflow_list' %}"
                                                   class="text-decoration-none">
                                                    <div class="quick-access-card bg-gradient-success text-white text-center p-4 rounded-lg shadow-lg h-100">
                                                        <div class="quick-access-icon mb-3">
                                                            <i class="fas fa-chart-line fa-3x"></i>
                                                        </div>
                                                        <h4 class="font-weight-bold mb-2">Finanzas</h4>
                                                        <p class="mb-0 opacity-75">Control de Cajas y Flujo de Caja</p>
                                                        <div class="mt-3">
                                                            <span class="badge badge-light text-success">Cajas</span>
                                                            <span class="badge badge-light text-success">Gastos</span>
                                                            <span class="badge badge-light text-success">Reportes</span>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        {% endif %}
                                        {% if user.has_access_to_all or user.has_access_to_hrm %}
                                            <div class="col-lg-3 col-md-6 mb-3">
                                                <a href="{% url 'apps.hrm:employee' %}" class="text-decoration-none">
                                                    <div class="quick-access-card bg-gradient-warning text-white text-center p-4 rounded-lg shadow-lg h-100">
                                                        <div class="quick-access-icon mb-3">
                                                            <i class="fas fa-users fa-3x"></i>
                                                        </div>
                                                        <h4 class="font-weight-bold mb-2">Recursos Humanos</h4>
                                                        <p class="mb-0 opacity-75">Sucursales y Empleados</p>
                                                        <div class="mt-3">
                                                            <span class="badge badge-light text-warning">Sucursales</span>
                                                            <span class="badge badge-light text-warning">Empleados</span>
                                                            <span class="badge badge-light text-warning">Gestión</span>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        {% endif %}
                                        {% if user.has_access_to_all or user.has_access_to_sales %}
                                            <div class="col-lg-3 col-md-6 mb-3">
                                                <a href="{% url 'apps.farm:product' %}" class="text-decoration-none">
                                                    <div class="quick-access-card bg-gradient-info text-white text-center p-4 rounded-lg shadow-lg h-100">
                                                        <div class="quick-access-icon mb-3">
                                                            <i class="fas fa-seedling fa-3x"></i>
                                                        </div>
                                                        <h4 class="font-weight-bold mb-2">Granja</h4>
                                                        <p class="mb-0 opacity-75">Gestión de Productos y Cultivos</p>
                                                        <div class="mt-3">
                                                            <span class="badge badge-light text-info">Productos</span>
                                                            <span class="badge badge-light text-info">Cultivos</span>
                                                            <span class="badge badge-light text-info">Aplicaciones</span>
                                                        </div>
                                                    </div>
                                                </a>
                                            </div>
                                        {% endif %}

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            {% endblock body %}
        </section>
        <!-- /.content -->
    </div>
    <!-- /.content-wrapper -->
    <footer class="main-footer roboto-condensed-regular text-center">
        <div class="container-fluid">
            <div class="row">
                <div class="col-12">
                    <small class="text-muted">
                        <strong>Copyright &copy; 2025-2026 <a href="https://4soluciones.net">4soluciones</a>.</strong>
                        All rights reserved. | <b>Version</b> 1.5
                    </small>
                </div>
            </div>
        </div>
    </footer>

    <!-- Control Sidebar -->
    <aside class="control-sidebar control-sidebar-dark">

    </aside>


    <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->

<!-- jQuery -->
<script src="{% static 'plugins/jquery/jquery.min.js' %}"></script>
<!-- jQuery UI 1.11.4 -->
<script src="{% static 'plugins/jquery-ui/jquery-ui.min.js' %}"></script>

<script src="{% static 'plugins/bootstrap-switch/js/bootstrap-switch.min.js' %}"></script>
<script src="{% static 'plugins/sweetalert2/sweetalert2.min.js' %}"></script>

<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<!-- <script>
    $.widget.bridge('uibutton', $.ui.button)
</script> -->
<!-- Bootstrap 4 -->
<script src="{% static 'plugins/bootstrap/js/bootstrap.bundle.min.js' %}"></script>
<!-- ChartJS -->
<script src="{% static 'plugins/chart.js/Chart.min.js' %}"></script>
<!-- Sparkline -->
<script src="{% static 'plugins/sparklines/sparkline.js' %}"></script>
<!-- JQVMap -->
<script src="{% static 'plugins/jqvmap/jquery.vmap.min.js' %}"></script>
<script src="{% static 'plugins/jqvmap/maps/jquery.vmap.usa.js' %}"></script>
<!-- jQuery Knob Chart -->
<script src="{% static 'plugins/jquery-knob/jquery.knob.min.js' %}"></script>
<!-- daterangepicker -->
<script src="{% static 'plugins/moment/moment.min.js' %}"></script>
<script src="{% static 'plugins/daterangepicker/daterangepicker.js' %}"></script>
<!-- Tempusdominus Bootstrap 4 -->
<script src="{% static 'plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js' %}"></script>
<!-- Summernote -->
<script src="{% static 'plugins/summernote/summernote-bs4.min.js' %}"></script>
<!-- overlayScrollbars -->
<script src="{% static 'plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js' %}"></script>
<!-- AdminLTE App -->
<script src="{% static 'assets/js/adminlte.js' %}"></script>
<!-- AdminLTE for demo purposes -->
{#<script src="{% static 'assets/js/demo.js' %}"></script>#}
<!-- AdminLTE dashboard demo (This is only for demo purposes) -->
{#<script src="{% static 'assets/js/pages/dashboard.js' %}"></script>#}

<script src="{% static 'assets/js/autocomplete.js' %}"></script>
<script src="{% static 'assets/toastr/toastr.min.js' %}"></script>
<script src="{% static 'plugins/inputmask/jquery.inputmask.min.js' %}"></script>
<script src="{% static 'plugins/bs-custom-file-input/bs-custom-file-input.min.js' %}"></script>

<script src="{% static 'vendor/select2/select2.min.js' %}"></script>
<script src="{% static 'vendor/datatables/datatables.min.js' %}"></script>
<script src="{% static 'vendor/datatables/datatables.language.js' %}"></script>
<!-- AdminLTE App -->
<script src="{% static 'plugins/fullcalendar/main.js' %}"></script>
<script src="{% static 'plugins/fullcalendar/locales/es.js' %}"></script>

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-database.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-storage.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-messaging.js"></script>
<!-- TODO: Add SDKs for Firebase products that you want to use
    https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.9.0/firebase-analytics.js"></script>

<script src="{% static 'assets/js/main.js' %}"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.js"></script>

{#<i class="fa-solid fa-user-chef"></i> <!-- uses solid style -->#}
{#<i class="fa-brands fa-github-square"></i> <!-- uses brand style -->#}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script src="{% static 'plugins/flot/jquery.flot.js' %}"></script>

<script src="{% static 'plugins/flot/plugins/jquery.flot.resize.js' %}"></script>

<script src="{% static 'plugins/flot/plugins/jquery.flot.pie.js' %}"></script>

<script src="https://cdn.canvasjs.com/canvasjs.min.js"></script>
<script src="https://cdnjs.com/libraries/Chart.js"></script>


{% block extrajs %}
    <script type="text/javascript">


    </script>
{% endblock extrajs %}
</body>
</html>
